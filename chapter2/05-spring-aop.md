## 第五节 Spring 中的 AOP

### 5.1 AOP 概念

**概念**：AOP 全称是 Aspect Oriented Programming 即面向切面编程。通过预编译方式和运行期动态代理实现程序功能的统一维护的一种技术。AOP 是 OOP 的延续，也是 Spring 框架的重要内容，是函数式编程的一种衍生范型。利用 AOP 可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高开发的效率。
* 简单的说，它就是把程序中重复的代码抽取出来，在需要执行的时候，使用动态代理的技术，在不修改源码的基础上，对已有方法进行增强。

**作用**：在程序运行期间，不修改源码对已有方法进行增强。

**优势**：
* 减少重复代码
* 提高开发效率
* 维护方便

**AOP 的实现方式**：使用动态代理技术

### 5.2 Spring 中的 AOP 术语和细节

#### 5.2.1 AOP 相关术语 

**Joinpoint(连接点):**

* 所谓连接点是指那些被拦截到的点。在 spring 中，这些点指的是方法，因为 spring 只支持方法类型的连接点。如账户的业务层接口 IAccountService 中的各个方法。

**Pointcut(切入点):**

* 所谓切入点是指要对哪些 Joinpoint 进行拦截的定义，即被增强的 Joinpoint。
* 所有的切入点都是连接点，但是并不是所有的连接点都一定是切入点。

**Advice(通知/增强):**

* 所谓通知是指拦截到 Joinpoint 之后所要做的事情就是通知。动态代理中 invoke 方法具有拦截功能。在拦截前（method.invoke）的语句是前置通知，拦截后的语句是后置通知。catch 语句块中的是异常通知，finally 语句块中的是最终通知。整个的 invoke 方法在执行就是环绕通知，在环绕通知中有明确的切入点方法调用。
* 通知的类型： 前置通知、后置通知、异常通知、最终通知、环绕通知。

Introduction(引介):
* 引介是一种特殊的通知在不修改类代码的前提下，Introduction 可以在运行期为类动态地添加一些方法或 Field。

Target(目标对象):
* 代理的目标对象，即被代理对象。

Weaving(织入):
* 是指把增强应用到目标对象来创建新的代理对象的过程。
* spring 采用动态代理织入，而 AspectJ 采用编译期织入和类装载期织入。

Proxy（代理） :
* 一个类被 AOP 织入增强后，就产生一个结果代理类。

Aspect(切面):
* 是切入点和通知（引介）的结合。 

#### 5.2.2 学习 Spring 中的 AOP 要明确的事 

**a、开发阶段（程序员）**

* 编写核心业务代码（开发主线）：大部分程序员来做，要求熟悉业务需求。
* 把公用代码抽取出来，制作成通知。（开发阶段最后再做）会 AOP 编程的人员来做。
* 在配置文件中，声明切入点与通知间的关系，即切面。会 AOP 编程的人员来做。

**b、运行阶段（Spring 框架完成）**

* Spring 框架监控切入点方法的执行。一旦监控到切入点方法被运行，使用代理机制，动态创建目标对象的代理对象，根据通知类别，在代理对象的对应位置，将通知对应的功能织入，完成完整的代码逻辑运行。


> 在 Spring 中，框架会根据目标类是否实现了接口来决定采用哪种动态代理的方式。

### 5.3  Spring基于 XML 的 AOP 

#### 5.3.1 编写必要的代码


#### 5.3.2 配置步骤 


### 5.4 

 

### 5.5     